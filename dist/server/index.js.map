{"version":3,"sources":["webpack:///webpack/bootstrap a0d20b662e7d86cc80fc","webpack:///external \"path\"","webpack:///external \"fs\"","webpack:///external \"webpack\"","webpack:///./src/server/index.js","webpack:///external \"express\"","webpack:///external \"helmet\"","webpack:///external \"compression\"","webpack:///external \"basic-auth\"","webpack:///external \"body-parser\"","webpack:///external \"serve-static\"","webpack:///external \"babel-polyfill\"","webpack:///./src/server/common/logger.js","webpack:///external \"winston\"","webpack:///external \"moment\"","webpack:///./src/server/redirects.js","webpack:///external \"webpack-dev-middleware\"","webpack:///external \"webpack-hot-middleware\"","webpack:///./webpack.dev.config.babel.js","webpack:///external \"html-webpack-plugin\"","webpack:///external \"webpack-shell-plugin\"","webpack:///./src/server/utilities/externals.js"],"names":["app","get","req","res","status","end","use","hsts","noSniff","process","env","NODE_ENV","username","AUTH_USER","password","AUTH_PASS","next","user","undefined","name","pass","statusCode","setHeader","urlencoded","extended","json","raw","limit","type","webpack","require","webpackDevMiddleware","webpackHotMiddleware","clientConfig","compiler","noInfo","publicPath","output","info","filename","join","outputPath","outputFileSystem","readFile","err","result","set","send","index","dotfiles","maxAge","setHeaders","path","mime","lookup","sendFile","resolve","preferredPort","PORT","listen","error","date","timestamp","format","mkdir","configure","transports","Console","level","colorize","humanReadableUnhandledException","File","maxsize","prettyPrint","log","message","warn","homepageRedirects","redirectToHomepage","find","x","match","RegExp","redirect","baseConfig","extensions","module","rules","test","exclude","plugins","devtool","entry","client","__dirname","loader","options","importLoaders","sourceMap","svgo","removeTitle","floatPrecision","inject","chunks","template","DefinePlugin","JSON","stringify","NamedModulesPlugin","optimize","OccurrenceOrderPlugin","HotModuleReplacementPlugin","NoEmitOnErrorsPlugin","devServer","contentBase","hot","externals","jquery","serverConfig","dev","push","onBuildEnd","target","readdirSync","filter","indexOf","forEach","mod"],"mappings":"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","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap a0d20b662e7d86cc80fc","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 0\n// module chunks = 0","module.exports = require(\"fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs\"\n// module id = 1\n// module chunks = 0","module.exports = require(\"webpack\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"webpack\"\n// module id = 2\n// module chunks = 0","import express from 'express';\nimport helmet from 'helmet';\nimport path from 'path';\nimport compression from 'compression';\nimport auth from 'basic-auth';\nimport bodyParser from 'body-parser';\nimport serveStatic from 'serve-static';\nimport 'babel-polyfill';\nimport logger from './common/logger';\nimport redirects from './redirects';\n\nconst app = express();\n\napp.get('/health', (req, res) => {\n  res.status(200).end();\n});\n\napp.use(helmet({\n  hsts: false,\n  noSniff: false\n}));\n\napp.use(compression());\n\nif (process.env.NODE_ENV !== 'production') {\n  const username = process.env.AUTH_USER || 'prototype';\n  const password = process.env.AUTH_PASS || 'prototype';\n  app.use((req, res, next) => {\n    const user = auth(req);\n    if (user === undefined || user.name !== username || user.pass !== password) {\n      res.statusCode = 401;\n      res.setHeader('WWW-Authenticate', 'Basic realm=\"prototype\"');\n      res.end('Unauthorized');\n    }\n    else {\n      next();\n    }\n  });\n}\n\napp.use((req, res, next) => {\n  res.setHeader('Access-Control-Allow-Origin', '*');\n  res.setHeader('Access-Control-Allow-Methods', 'GET,POST,OPTIONS,DELETE');\n  res.setHeader('Access-Control-Allow-Headers', 'Origin, X-Requested-With, Content-Type, Accept, Authorization');\n  res.setHeader('Access-Control-Allow-Credentials', true);\n\n  if (process.env.NODE_ENV !== 'production') {\n    res.setHeader('X-Robots-Tag', 'noindex, nofollow');\n  }\n\n  next();\n});\n\napp.get('/robots.txt', (req, res, next) => {\n  if (process.env.NODE_ENV !== 'production') {\n    res.end();\n  }\n  else {\n    next();\n  }\n});\n\napp.use(bodyParser.urlencoded({ extended: false }));\napp.use(bodyParser.json());\napp.use(bodyParser.raw({ limit: 2 * 1024 * 1024, type: 'application/octet-stream' })); // File uploads capped to 2 MB\n\nredirects(app);\n\nif (process.env.NODE_ENV === 'development') {\n  const webpack = require('webpack');\n  const webpackDevMiddleware = require('webpack-dev-middleware');\n  const webpackHotMiddleware = require('webpack-hot-middleware');\n  const clientConfig = require('../../webpack.dev.config.babel').clientConfig;\n\n  const compiler = webpack(clientConfig);\n\n  app.use(webpackDevMiddleware(compiler, {\n    noInfo: true,\n    publicPath: clientConfig.output.publicPath\n  }));\n\n  app.use(webpackHotMiddleware(compiler));\n\n  logger.info('Running webpack dev and hot middleware!');\n\n  app.use('*', (req, res, next) => {\n    const filename = path.join(compiler.outputPath, 'index.html');\n\n    compiler.outputFileSystem.readFile(filename, (err, result) => {\n      if (err) {\n        next(err);\n        return;\n      }\n\n      res.set('content-type', 'text/html');\n      res.send(result);\n      res.end();\n    });\n  });\n}\nelse {\n  app.use(serveStatic('dist/client', {\n    index: ['index.html'],\n    dotfiles: 'ignore',\n    maxAge: process.env.NODE_ENV === 'production' ? '7d' : '0d',\n    setHeaders: (res, path) => {\n      if (serveStatic.mime.lookup(path) === 'text/html') {\n        res.setHeader('Cache-Control', 'public, max-age=0');\n      }\n    }\n  }));\n\n  app.get('*', (req, res) => {\n    const filename = './dist/client/index.html';\n\n    res.sendFile(path.resolve(filename));\n  });\n}\n\n// app.get('*', (req, res) => {\n//   res.status(404).end();\n// });\n\nlogger.info('---------------------------');\nlogger.info('☕️ ');\nlogger.info('Starting Server');\nlogger.info(`Environment: ${process.env.NODE_ENV}`);\n\nconst preferredPort = process.env.PORT || 8080;\n\napp.listen(preferredPort, (error) => {\n  if (!error) {\n    logger.info(`📡  Running on port: ${preferredPort}`);\n  }\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/server/index.js","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 4\n// module chunks = 0","module.exports = require(\"helmet\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"helmet\"\n// module id = 5\n// module chunks = 0","module.exports = require(\"compression\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"compression\"\n// module id = 6\n// module chunks = 0","module.exports = require(\"basic-auth\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"basic-auth\"\n// module id = 7\n// module chunks = 0","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 8\n// module chunks = 0","module.exports = require(\"serve-static\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"serve-static\"\n// module id = 9\n// module chunks = 0","module.exports = require(\"babel-polyfill\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-polyfill\"\n// module id = 10\n// module chunks = 0","import winston from 'winston';\nimport moment from 'moment';\nimport fs from 'fs';\n\nconst date = moment();\nconst timestamp = date.format('YYYY-MM-DD_hh-mm-ss');\n\n// Create logs directory if it doesn't exist\nfs.mkdir('./logs', () => { });\n\nwinston.configure({\n  transports: [\n    new (winston.transports.Console)({\n      level: 'info',\n      timestamp: true,\n      colorize: true,\n      humanReadableUnhandledException: true\n    }),\n    new (winston.transports.File)({\n      filename: `./logs/${timestamp}_log.log`,\n      level: 'info',\n      timestamp: true,\n      maxsize: 1024 * 1024 * 10, // 10 MB rolling log files\n      prettyPrint: true,\n      json: false\n    })\n  ]\n});\n\nexport default {\n  info: message => {\n    winston.log('info', message);\n  },\n  warn: message => {\n    winston.log('warn', message);\n  },\n  error: message => {\n    winston.log('error', message);\n  }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/server/common/logger.js","module.exports = require(\"winston\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"winston\"\n// module id = 12\n// module chunks = 0","module.exports = require(\"moment\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"moment\"\n// module id = 13\n// module chunks = 0","/*\n* Redirect rules\n*/\n\nconst homepageRedirects = [\n  '/some-unwanted-path',\n  '/another-unwanted-path'\n];\n\nexport default (app) => {\n  app.get('*', (req, res, next) => {\n    const redirectToHomepage = homepageRedirects.find(x => x.match(new RegExp(`^${req.path}$`)));\n    if (redirectToHomepage) {\n      res.redirect(301, '/');\n    }\n    else {\n      next();\n    }\n  });\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/server/redirects.js","module.exports = require(\"webpack-dev-middleware\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"webpack-dev-middleware\"\n// module id = 15\n// module chunks = 0","module.exports = require(\"webpack-hot-middleware\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"webpack-hot-middleware\"\n// module id = 16\n// module chunks = 0","import path from 'path';\nimport webpack from 'webpack';\nimport HtmlWebpackPlugin from 'html-webpack-plugin';\nimport WebpackShellPlugin from 'webpack-shell-plugin';\nimport externals from './src/server/utilities/externals';\n\nconst baseConfig = {\n  resolve: {\n    extensions: ['.js', '.jsx']\n  },\n  module: {\n    rules: [{\n      test: /\\.js$/,\n      exclude: /node_modules/,\n      use: 'babel-loader'\n    }]\n  },\n  plugins: [],\n  devtool: 'source-map'\n};\n\nexport const clientConfig = {\n  ...baseConfig,\n  entry: {\n    client: [\n      'react-hot-loader/patch',\n      'webpack-hot-middleware/client',\n      './src/client/index.js'\n    ]\n  },\n  output: {\n    filename: 'main.[name].js',\n    path: path.resolve(__dirname, 'dist/client'),\n    publicPath: '/'\n  },\n  resolve: {\n    extensions: [...baseConfig.resolve.extensions, '.scss']\n  },\n  module: {\n    ...baseConfig.module,\n    rules: [\n      ...baseConfig.module.rules,\n      {\n        test: /\\.scss$/,\n        use: [{\n          loader: 'style-loader'\n        }, {\n          loader: 'css-loader',\n          options: {\n            importLoaders: 1,\n            sourceMap: true\n          }\n        },\n        {\n          loader: 'postcss-loader',\n          options: {\n            sourceMap: true\n          }\n        }, {\n          loader: 'sass-loader',\n          options: {\n            sourceMap: true\n          }\n        }\n        ]\n      },\n      {\n        test: /\\.svg$/,\n        use: [\n          'babel-loader',\n          {\n            loader: 'react-svg-loader',\n            options: {\n              svgo: {\n                plugins: [{\n                  removeTitle: true\n                }],\n                floatPrecision: 2\n              }\n            }\n          }\n        ]\n      },\n      {\n        test: /\\.(png|jpg|gif)$/,\n        use: [\n          'file-loader'\n        ]\n      }\n    ]\n  },\n  plugins: [\n    ...baseConfig.plugins,\n    new HtmlWebpackPlugin({\n      inject: true,\n      chunks: ['client'],\n      template: 'src/client/index.html',\n      filename: './index.html'\n    }),\n    new webpack.DefinePlugin({\n      'process.env.CLIENT_ENV': JSON.stringify(process.env.NODE_ENV)\n    }),\n    new webpack.NamedModulesPlugin(),\n    new webpack.optimize.OccurrenceOrderPlugin(),\n    new webpack.HotModuleReplacementPlugin(),\n    new webpack.NoEmitOnErrorsPlugin()\n  ],\n  devServer: {\n    contentBase: './dist',\n    hot: true\n  },\n  externals: {\n    jquery: 'jQuery'\n  }\n};\n\nexport const serverConfig = env => {\n  const plugins = [\n    ...baseConfig.plugins\n  ];\n\n  if (env && env.dev) {\n    plugins.push(new WebpackShellPlugin({\n      onBuildEnd: ['cross-env NODE_ENV=development DEBUG=api nodemon ./dist/server/index.js'],\n      dev: true\n    }));\n  }\n\n  return {\n    ...baseConfig,\n    entry: './src/server/index.js',\n    target: 'node',\n    output: {\n      filename: 'index.js',\n      path: path.resolve(__dirname, 'dist/server'),\n      publicPath: '/'\n    },\n    module: {\n      ...baseConfig.module,\n      rules: [\n        ...baseConfig.module.rules\n      ]\n    },\n    plugins,\n    externals\n  };\n};\n\nexport default [\n  clientConfig,\n  serverConfig\n];\n\n\n\n// WEBPACK FOOTER //\n// ./webpack.dev.config.babel.js","module.exports = require(\"html-webpack-plugin\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"html-webpack-plugin\"\n// module id = 18\n// module chunks = 0","module.exports = require(\"webpack-shell-plugin\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"webpack-shell-plugin\"\n// module id = 19\n// module chunks = 0","/**\n * Allows backend to be transpiled without packing modules from node_modules.\n */\n\nimport fs from 'fs';\n\nconst externals = {};\n\nfs.readdirSync('node_modules')\n  .filter(x => ['.bin'].indexOf(x) === -1)\n  .forEach((mod) => {\n    externals[mod] = `commonjs ${mod}`;\n  });\n\nexport default externals;\n\n\n\n// WEBPACK FOOTER //\n// ./src/server/utilities/externals.js"],"sourceRoot":""}